<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns:f="http://xmlns.jcp.org/jsf/core" 
      xmlns:h="http://xmlns.jcp.org/jsf/html" 
      xmlns:p="http://primefaces.org/ui" 
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets" 
      xmlns="http://www.w3.org/1999/xhtml">
    <h:head>
        <meta charset="utf-8"></meta>
        <title>SigerWeb - Usuarios</title>
        <h:outputStylesheet library="bootstrap" name="css/bootstrap.min.css" />
        <h:outputStylesheet library="font-awesome-4.3.0" name="css/font-awesome.min.css" />
        <h:outputStylesheet library="css" name="pace.css" />
        <h:outputStylesheet library="css" name="colorbox/colorbox.css" />
        <h:outputStylesheet library="css" name="morris.css" />
        <h:outputStylesheet library="css" name="endless.min.css" />
        <h:outputStylesheet library="css" name="endless-skin.css" />
        <h:outputStylesheet library="css" name="usuarios.css" />
        <h:outputScript library="js" name="jquery-1.10.2.min.js" />
        <h:outputScript library="bootstrap" name="/js/bootstrap.js" />
        <h:outputScript library="js" name="jquery.flot.min.js" />
        <h:outputScript library="js" name="rapheal.min.js" />
        <h:outputScript library="js" name="morris.min.js" />
        <h:outputScript library="js" name="jquery.colorbox.min.js" />
        <h:outputScript library="js" name="jquery.sparkline.min.js" />
        <h:outputScript library="js" name="/uncompressed/pace.js" />
        <h:outputScript library="js" name="jquery.popupoverlay.min.js" />
        <h:outputScript library="js" name="jquery.slimscroll.min.js" />
        <h:outputScript library="js" name="modernizr.min.js" />
        <h:outputScript library="js" name="jquery.cookie.min.js" />
        <h:outputScript library="js" name="/endless/endless_dashboard.js" />
        <h:outputScript library="js" name="/endless/endless.js" />
        <h:outputScript library="primefaces" name="jquery.js" />
        <link rel="shortcut icon" href="resources/img/icono.ico" type="image/x-icon" />
    </h:head>
    <h:body>
        <p:growl id="growl" showDetail="true" sticky="true" />
        <!-- Overlay Div -->
        <div id="overlay" class="transparent"></div>        
        <ui:include src="barraSuperior.xhtml" />
        <ui:include src="barraLateral.xhtml" />
        <div id="main-container">
            <ui:include src="barraAdministrativo.xhtml" />

            <div id="opciones">
                <div class="panel panel-default">
                    <div class="panel-heading"> <h1>Usuarios</h1> </div>
                    <div class="panel-tab clearfix">
                        <ul class="tab-bar">
                            <li class="active"><a href="#tabConfirmar" data-toggle="tab"><i class="fa fa-check-circle-o"></i> Confirmar gestores</a></li>
                            <li><a href="#tabRegistrar" data-toggle="tab"><i class="fa fa-pencil"></i> Registrar nuevo usuario</a></li>
                            <li><a href="#tabBuscar" data-toggle="tab"><i class="fa fa-search"></i> Buscar usuario</a></li>
                        </ul>
                    </div>
                    <div class="panel-body">
                        <div class="tab-content">
                            <div class="tab-pane fade in active" id="tabConfirmar">
                                <h:form>
                                    <div id="confirmagestores" class="panel bg-danger">
                                        <div class="panel-body">
                                            <h4>Confirme o elimine a los usuarios en espera de ingresar al sistema.</h4>
                                            <!--<div id="botonazo"> <a href="#formModalConfirmaGestores" role="button" data-toggle="modal" class="btn btn-default btn-sm">Confirmar</a> </div>-->
                                            <!-- AQUI VA EL PINCHE VALOR DEL BEAN PARA VER CUANTOS USUARIOS TIENEN ESTATUS -2 -->                            
                                            <!--<strong class="pull-left m-top-xs">Confirme o elimine a los usuarios en espera de ingresar al sistema.</strong>-->
                                            <!-- ESTE ES EL DIALOGO QUE SE ABRE CUANDO PRESIONAMOS EL BOTON DE CONFIRMAR GESTORES -->
                                            <!-- CISNE SOURCECODE -->
                                            <!--<div class="modal fade" id="formModalConfirmaGestores">-->
                                            <!--<div class="modal-dialog">-->
                                            <h:form id="formConfirmarGestores">
                                                <!--<p:messages id="messages" showDetail="true" autoUpdate="true" closable="true" />-->
                                                <!--<div class="modal-content">-->
                                                <!--<div class="modal-header"> <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button> <h4>Confirmar gestores</h4> </div>-->
                                                <!--<div class="modal-body">-->
                                                <h:form id="tabla">
                                                    <p:dataTable id="noConfirmados" var="usuarios" value="#{usuariosBean.gestoresNoConfirmados}" selection="#{usuariosBean.usuariosSeleccionados}" rowKey="#{usuarios.nombreLogin}" paginator="true" rows="10">
                                                        <!--<p:ajax event="" />-->
                                                        <f:facet name="header"> Usuarios no confirmados </f:facet>
                                                        <p:column selectionMode="multiple" style="width:30px;text-align:right" />
                                                        <p:column headerText="Nombre del usuario" style="width:110px;">
                                                            <h:outputText value="#{usuarios.nombre}" />
                                                        </p:column>
                                                        <p:column headerText="Apellido Paterno" style="width:100px;">
                                                            <h:outputText value="#{usuarios.paterno}" />
                                                        </p:column>
                                                        <p:column headerText="Apellido Materno" style="width:100px;">
                                                            <h:outputText value="#{usuarios.materno}" />
                                                        </p:column>
                                                        <p:column headerText="Correo" style="width:200px;">
                                                            <h:outputText value="#{usuarios.correo}" />
                                                        </p:column>
                                                        <f:facet name="footer">
                                                            <p:commandButton process="noConfirmados" icon="ui-icon-check" value="Confirmar" actionListener="#{usuariosBean.confirmarGestores(usuariosBean.usuariosSeleccionados)}" />
                                                            <p:commandButton process="noConfirmados" icon="ui-icon-trash" value="Eliminar" actionListener="#{usuariosBean.eliminarGestores(usuariosBean.usuariosSeleccionados)}" />
                                                        </f:facet>
                                                    </p:dataTable>
                                                </h:form>
                                                <!-- </div> --> <!-- /.modal-body -->
                                                <!-- </div> --><!-- /.modal-content -->
                                            </h:form>
                                            <!--</div>--> <!-- /.modal-dialog -->
                                            <!-- </div> --> <!-- /.modal -->
                                        </div> <!-- /.panel-body -->
                                    </div> <!-- /#confirmagestores -->
                                </h:form>                            
                            </div>

                            <div class="tab-pane fade" id="tabRegistrar">
                                <h:form>
                                    <div id="nuevousuario" class="panel bg-info">
                                        <div class="panel-body">
                                            <h4>Agregue un gestor o administrativo al sistema.</h4>
                                            <!--<div id="botonazo"> <a href="#formModalNuevoUsuario" role="button" data-toggle="modal" class="btn btn-default btn-sm">Nuevo usuario</a> </div>-->
                                            <!--<strong class="pull-left m-top-xs">Agregue un gestor o administrativo al sistema.</strong>-->
                                            <!-- DAR DE ALTA UN NUEVO USUARIO -->
                                            <!--<div class="modal fade" id="formModalNuevoUsuario">-->
                                            <!--<div class="modal-dialog">-->
                                            <h:form id="formNuevoUsuario">
                                                <!--<p:messages id="messages" showDetail="true" autoUpdate="true" closable="true" />-->
                                                <!--<div class="modal-content">--><div class="">
                                                    <!--<div class="modal-header"> <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button> <h4>Nuevo Usuario</h4> </div>-->
                                                    <!--<div class="modal-body">--><div class="">
                                                        <div class="form-group">
                                                            <p:outputLabel value="Nombre(s): " />
                                                            <p:inputText id="nombre" type="text" class="form-control input-sm" value="#{usuariosBean.nombre}"
                                                                         required="true" requiredMessage="Ingrese un nombre"/>
                                                        </div><!-- /form-group -->
                                                        <div class="row">
                                                            <div class="col-md-6">
                                                                <div class="form-group">
                                                                    <p:outputLabel value="Apellido Paterno:" />
                                                                    <p:inputText id="paterno" type="text" class="form-control input-sm" value="#{usuariosBean.paterno}" />
                                                                </div>
                                                            </div><!-- /.col -->
                                                            <div class="col-md-6">
                                                                <div class="form-group">
                                                                    <p:outputLabel id="materno" value="Apellido Materno:" />
                                                                    <p:inputText type="text" class="form-control input-sm" value="#{usuariosBean.materno}" />
                                                                </div>
                                                            </div><!-- /.col -->
                                                        </div><!-- /.row -->
                                                        <div class="form-group">
                                                            <p:outputLabel id="nombreUsuario" value="Nombre de Usuario: " />
                                                            <p:inputText type="text" class="form-control input-sm" value="#{usuariosBean.nombreLogin}"
                                                                         required="true" requiredMessage="Ingrese un nombre de usuario" />
                                                        </div><!-- /form-group -->
                                                        <div class="row">
                                                            <div class="col-md-6">
                                                                <div class="form-group">
                                                                    <p:outputLabel value="Contraseña:" />
                                                                    <p:password id="password" class="form-control input-sm" value="#{usuariosBean.password}"
                                                                                required="true" requiredMessage="Ingrese una contraseña"/>
                                                                </div>
                                                            </div><!-- /.col -->
                                                            <div class="col-md-6">
                                                                <div class="form-group">
                                                                    <p:outputLabel id="confirmePassword" value="Confirme su Contraseña:" />
                                                                    <p:password class="form-control input-sm" value="#{usuariosBean.confirmePassword}" />
                                                                </div>
                                                            </div><!-- /.col -->
                                                        </div><!-- /.row -->
                                                        <div class="form-group">
                                                            <p:outputLabel value="E-mail: " />
                                                            <p:inputText type="text" class="form-control input-sm" value="#{usuariosBean.correo}"
                                                                         required="true" requiredMessage="Ingrese una dirección de correo electrónico"/>
                                                        </div><!-- /form-group -->
                                                        <div class="form-group">
                                                            <p:outputLabel value="Perfil: " />
                                                            <h:selectOneMenu id="perfil" value="#{usuariosBean.perfil}" class="form-control chzn-select"
                                                                             required="true" requiredMessage="Especifique perfil">
                                                                <f:selectItem itemLabel="Seleccione perfil"/>
                                                                <f:selectItem itemLabel="Administrador" itemValue="1" />
                                                                <f:selectItem itemLabel="Gestor" itemValue="2" />
                                                            </h:selectOneMenu>
                                                        </div><!-- /form-group -->
                                                    </div>
                                                    <!--<div class="modal-footer">--><div class="">
                                                        <p:commandButton styleClass="btn btn-danger tooltip-test" actionListener="#{usuariosBean.insertar}" value="Aceptar"/>
                                                        <p:commandButton styleClass="btn btn-success btn-sm tooltip-test" type="reset" value="Agregar Otro" />
                                                    </div> <!-- .modal-footer -->
                                                </div> <!-- /.modal-content -->
                                            </h:form> <!-- #formNuevoUsuario  -->
                                            <!--</div>--> <!-- /.modal-dialog -->
                                            <!--</div>--> <!-- /.modal -->
                                        </div> <!-- .panel-body  -->
                                    </div> <!-- #nuevousuario  -->
                                </h:form>
                            </div> <!-- #tabRegistrar -->

                            <div class="tab-pane fade" id="tabBuscar">
                                <h:form>
                                    <div id="buscausuarios" class="panel bg-primary">
                                        <div class="panel-body">
                                            <h4>Consulte y modifique a los usuarios del sistema.</h4>
                                            <!--<div id="botonazo"> <a href="#formModalBuscarUsuarios" role="button" data-toggle="modal" class="btn btn-default btn-sm">Buscar</a> </div>-->
                                            <!--<strong class="pull-left m-top-xs">Consulte y modificar a los usuarios del sistema.</strong>-->
                                            <!--<div class="modal fade" id="formModalBuscarUsuarios">-->
                                            <!--<div class="modal-dialog" id="dialogoBuscarUsuarios">-->
                                            <!--<h:form>-->
                                            <!--<div class="modal-content">-->
                                            <!--<div class="modal-header"> <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button> <h4>Buscar usuarios</h4> </div>-->
                                            <!--<div class="modal-body">-->
                                            <div class="form-group">
                                                <h:form id="form">
                                                    <p:contextMenu for="usuarios">
                                                        <p:menuitem value="Ver detalle" update="usuarioDetail" icon="ui-icon-search" oncomplete="PF('usuarioDialog').show()" />
                                                    </p:contextMenu>

                                                    <p:dataTable id="usuarios" var="usuario" value="#{usuariosBean.todosUsuarios}" widgetVar="usuarioDataTable" paginator="true" rows="10"
                                                                 emptyMessage="Ning&uacute;n usuario coincide con el criterio de b&uacute;squeda." filteredValue="#{usuariosBean.usuariosEncontrados}"
                                                                 rowKey="#{usuario.nombreLogin}" selection="#{usuariosBean.usuarioSeleccionado}" selectionMode="single">

                                                        <f:facet name="header">
                                                            <p:outputPanel>
                                                                <h:outputText value="Buscar en todos los usuarios:  " />
                                                                <p:inputText id="globalFilter" onkeyup="PF('usuarioDataTable').filter()" style="width:150px" placeholder="Palabra clave"/>
                                                            </p:outputPanel>
                                                        </f:facet>

                                                        <p:column headerText="Nombre" filterBy="#{usuario.nombre}" filterMatchMode="contains"> 
                                                            <h:outputText value="#{usuario.nombre}"/>
                                                        </p:column>

                                                        <p:column headerText="Apellido paterno" filterBy="#{usuario.paterno}" filterMatchMode="contains">
                                                            <h:outputLink value="" >
                                                                #{usuario.paterno}
                                                            </h:outputLink>
                                                        </p:column>

                                                        <p:column headerText="Apellido materno" filterBy="#{usuario.materno}" filterMatchMode="contains">
                                                            <h:outputLink value="" >
                                                                #{usuario.materno}
                                                            </h:outputLink>
                                                        </p:column>

                                                        <p:column headerText="Nombre login" filterBy="#{usuario.nombreLogin}" filterMatchMode="contains">
                                                            <h:outputLink value="" >
                                                                #{usuario.nombreLogin}
                                                            </h:outputLink>
                                                        </p:column>
                                                    </p:dataTable>

                                                    <p:dialog header="Informaci&oacute; detallada del usuario" widgetVar="usuarioDialog" modal="true" showEffect="fade" hideEffect="fade" resizable="false">
                                                        <p:outputPanel id="usuarioDetail" style="text-align:center;">
                                                            <p:panelGrid  columns="2" rendered="#{not empty usuariosBean.usuario}" columnClasses="label,value">
                                                                <f:facet name="header">
                                                                    <p:graphicImage name="demo/images/car/#{usuariosBean.usuarioSeleccionado.imagenPerfil}-big.gif"/> 
                                                                </f:facet>

                                                                <h:outputText value="Nombre: " />
                                                                <h:outputText value="#{usuariosBean.usuarioSeleccionado.nombre}" />

                                                                <h:outputText value="Apellido paterno: " />
                                                                <h:outputText value="#{usuariosBean.usuarioSeleccionado.paterno}" />

                                                                <h:outputText value="Apellido materno: " />
                                                                <h:outputText value="#{usuariosBean.usuarioSeleccionado.materno}" />

                                                                <h:outputText value="Nombre login: " />
                                                                <h:outputText value="$#{usuariosBean.usuarioSeleccionado.nombreLogin}" />

                                                                <h:outputText value="Perfil: " />
                                                                <h:outputText value="$#{usuariosBean.usuarioSeleccionado.perfil}" style="color:red"/>

                                                                <h:outputText value="Correo: " />
                                                                <h:outputText value="$#{usuariosBean.usuarioSeleccionado.correo}" />

                                                            </p:panelGrid>
                                                        </p:outputPanel>
                                                    </p:dialog>

                                                </h:form>
                                            </div> <!-- /form-group -->
                                            <!--</div> -->  <!-- .modal-body -->
                                            <!--<div class="modal-footer"> <p:commandButton styleClass="btn btn-danger tooltip-test" actionListener="#{pruebaBean.mostrar()}" value="Aceptar" /> </div>-->
                                            <!-- </div> --> <!-- .modal-content -->
                                            <!--</h:form>-->
                                            <!--</div>--> <!-- .modal-dialog -->
                                            <!--</div>--> <!-- .modal -->
                                        </div>
                                    </div>
                                </h:form>                    
                            </div> <!-- #tabBuscar -->
                        </div> <!-- .tabContent -->
                    </div> <!-- .panelbody -->
                </div><!-- /panel -->
            </div> <!-- #opciones -->
        </div><!-- /main-container -->

        <!-- Footer ================================================== -->
        <ui:include src="barraInferior.xhtml" />
    </h:body>
</html>
