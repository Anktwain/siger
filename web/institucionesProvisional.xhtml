<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns:f="http://xmlns.jcp.org/jsf/core" 
      xmlns:h="http://xmlns.jcp.org/jsf/html" 
      xmlns:p="http://primefaces.org/ui" 
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets" 
      xmlns="http://www.w3.org/1999/xhtml">
  <h:head>
    <meta charset="utf-8"></meta>
    <title>SigerWeb - Instituciones</title>
    <link rel="shortcut icon" href="resources/img/iconos/icono1.ico" type="image/x-icon" />
  </h:head> 
  <h:body>
    <p:growl id="growl" showDetail="true" sticky="true" />
    <div id="overlay" class="transparent" style="display: none;"></div>
    <ui:include src="barraSuperior.xhtml" />
    <ui:include src="barraLateral.xhtml" />
    <div id="main-container">
      <div id="breadcrumb">
        <ul class="breadcrumb">
          <li>
            <i class="fa fa-home">
            </i>
            <a href="#{indexBean.vista}">Inicio</a>
          </li>
          <li class="active">
            Instituciones
          </li>
        </ul>
      </div>
      <div class="main-header clearfix">
        <div class="page-title">
          <h3 class="no-margin">Instituciones</h3>
          <span>Consulte informaci&oacute;n de las instituciones, registre a una nueva, modifique o elimine las instituciones registradas</span>
        </div>
      </div>
      <div class="panel panel-default">
        <div class="padding-md">
          <div class="col-sm-6 col-md-3">
            <div class="panel-stat3 bg-danger">
              <h3 class="m-top-none">Nueva empresa</h3>
              <div id="botonazo">
                <p:commandButton value="Agregar" class="btn btn-default" onclick="PF('dlgNuevaEmpresa').show();" />

              </div>
              <div class="stat-icon">
                <i class="fa fa-plus fa-2x" />
              </div>
            </div>
            <div class="panel-stat3 bg-info">
              <h3 class="m-top-none">Editar empresa</h3>
              <div id="botonazo">
                <!-- LINEA ORIGINAL  <p:commandButton value="Editar" class="btn btn-default" onclick="PF('dlgEditarEmpresa').show();" />-->
                <p:commandButton value="Agregar Zona" class="btn btn-default" onclick="PF('dlgNuevaZona').show();" /> 
              </div>
              <div class="stat-icon">
                <i class="fa fa-pencil fa-2x" />
              </div>
            </div>
          </div>
        </div>
      </div>
    </div><!-- /main-container -->
    <ui:include src="barraInferior.xhtml" /><!-- Footer -->
    <!-- DIALOGOS -->
    <!-- DIALOGO DE NUEVA EMPRESA -->
    <p:dialog widgetVar="dlgNuevaEmpresa" width="40%" header="Agregar una empresa" modal="true" resizable="false">
      <h:form id="formNuevaEmpresa">
        <div class="modal-header">
          <h4>Registre a una empresa en el sistema</h4>
        </div>
        <div class="modal-body">
          <!-- FORMULARIO PARA REGISTRAR UNA NUEVA EMPRESA -->
          <h:outputText value="Razon Social:" />
          <br />
          <p:inputText id="razon" value="#{vistaEmpresas.sujetoBean.nombreRazonSocial}" size="50" maxlenght="100" required="true" requiredMessage="Debe ingresar una razon social" />
          <p:tooltip for="razon" value="Indique el nombre completo de la empresa incluyendo el tipo de sociedad de la que se trata" />
          <br />
          <h:outputText value="RFC:" />
          <br />
          <p:inputText id="errefece" value="#{vistaEmpresas.sujetoBean.rfc}" size="12" maxlenght="12" required="true" requiredMessage="Debe ingresar un RFC" />
          <p:tooltip for="errefece" value="Indique la clave del Registro Federal de Contribuyentes" />
          <br />
          <h:outputText value="Nombre Corto:" />
          <br />
          <p:inputText id="cortito" value="#{vistaEmpresas.empresaBean.nombreCorto}" size="20" maxlenght="25" required="true" requiredMessage="Debe ingresar un nombre corto para la empresa" />
          <p:tooltip for="cortito" value="Indique un nombre clave para identificar a esta empresa" />
          <br />
          <!-- AREA DE BOTONES PARA AGREGAR DATOS ADICIONALES DE LA EMPRESA -->
          <p:separator />
          <h4>
            <h:outputText value="Agregue telefonos, correos, contactos y direcciones:" />
          </h4>
          <br />
          <!-- BOTON PARA AGREGAR UN TELEFONO -->
          <p:commandButton id="btnTelsEmpresa" icon="fa fa-phone" type="button">
            <p:tooltip for="btnTelsEmpresa" value="Registre un numero telefonico para esta empresa" />
            <p:overlayPanel id="pnlTelsEmpresa" for="btnTelsEmpresa" hideEffect="size" dynamic="true" style="width: 300px">
              Numero:
              <br />
              <p:inputText id="numero" value="#{vistaEmpresas.telefonoBean.numero}" size="15" maxlenght="15" />
              <p:tooltip for="numero" value="Indique el numero de la empresa sin clave lada" />
              <br />
              Tipo:
              <br />
              <p:inputText id="tipo" value="#{vistaEmpresas.telefonoBean.tipo}" size="25" maxlenght="25" />
              <p:tooltip for="tipo" value="Indique si es un numero de casa, oficina, etc." />
              <br />
              Clave Lada:
              <br />
              <p:inputText id="lada" value="#{vistaEmpresas.telefonoBean.lada}" size="3" maxlenght="3" />
              <p:tooltip for="lada" value="Indique la clave lada del telefono proporcionado" />
              <br />
              Horario de llamadas:
              <br />
              <p:inputText id="hora" value="#{vistaEmpresas.telefonoBean.horario}" size="25" maxlenght="50" />
              <p:tooltip for="hora" value="Indique un horario de atencion para realizar llamadas" />
            </p:overlayPanel>
          </p:commandButton>
          <!-- BOTON PARA AGREGAR UN CORREO ELECTRONICO -->
          <p:commandButton id="btnCorreoEmpresa" icon="fa fa-envelope-o" type="button">
            <p:tooltip for="btnCorreoEmpresa" value="Registre un correo electronico para esta empresa" />
            <p:overlayPanel id="pnlCorreoEmpresa" for="btnCorreoEmpresa" hideEffect="size" dynamic="true" style="width: 300px">
              Direccion de correo electronico:
              <br />
              <p:inputText id="correo" value="#{vistaEmpresas.emailBean.direccion}" size="30" maxlenght="100" />
              <p:tooltip for="correo" value="Indique una direccion de correo electronico de la empresa" />
            </p:overlayPanel>
          </p:commandButton>
          <!-- BOTON PARA AGREGAR UN CONTACTO -->
          <p:commandButton id="btnContactosEmpresa" icon="fa fa-user" type="button">
            <p:tooltip for="btnContactosEmpresa" value="Registre un contacto de esta empresa" />
            <p:overlayPanel id="pnlContactosEmpresa" for="btnContactosEmpresa" hideEffect="size" dynamic="true" style="width: 300px">
              Nombre del contacto:
              <br />
              <p:inputText id="nombreContacto" value="#{vistaEmpresas.sujetoBean.nombreRazonSocial}" size="30" maxlenght="100" />
              <p:tooltip for="nombreContacto" value="Indique el nombre del contacto" />
              <br />
              RFC:
              <br />
              <p:inputText id="rfcContacto" value="#{vistaEmpresas.sujetoBean.rfc}" size="13" maxlenght="13" />
              <p:tooltip for="rfcContacto" value="Indique la clave del Registro Federal de Contribuyentes" />
              <br />
              Observaciones:
              <br />
              <p:inputText id="obs" value="#{vistaEmpresas.contactoBean.observaciones}" size="30" maxlenght="50" />
              <p:tooltip for="obs" value="Agregue observaciones para este contacto (cargo, parentezco, etc...)" />
            </p:overlayPanel>
          </p:commandButton>
          <!-- BOTON PARA AGREGAR UNA DIRECCION -->
          <p:commandButton id="btnDireccionEmpresa" icon="fa fa-map-marker" type="button">
            <p:tooltip for="btnDireccionEmpresa" value="Registre una direccion para esta empresa" />
            <p:overlayPanel id="pnldireccionEmpresa" for="btnDireccionEmpresa" hideEffect="size" dynamic="true" style="width: 500px">
              Calle:
              <br />
              <p:inputText id="calle" required="true" requiredMessage="Ingrese una calle" value="#{vistaEmpresas.calle}" size="50" maxlenght="50" />
              <p:tooltip for="calle" value="Indique la calle donde se ubica la empresa" />
              <br />
              <br />
              Numero Exterior:
              &nbsp;
              <p:inputText id="ext" required="true" requiredMessage="Ingrese un numero exterior" value="#{vistaEmpresas.numext}" size="5" maxlenght="15" />
              <p:tooltip for="ext" value="Indique el numero exterior de la empresa" />
              &nbsp;&nbsp;
              Numero Interior:
              &nbsp;
              <p:inputText id="int" value="#{vistaEmpresas.numint}" size="10" maxlenght="20" />
              <p:tooltip for="int" value="Indique el numero interior, edificio, local, etc. de la empresa" />
              <br />
              <br />
              Estado:
              &nbsp;
              <p:selectOneMenu id="comboboxEdo" value="#{vistaEmpresas.direccionBean.estado.idEstado}" style="width: 250px" filter="true">
                <p:ajax listener="#{vistaEmpresas.direccionBean.listarMunicipiosPorEstado()}" update="comboboxMpio,growl" />
                <f:selectItem itemLabel="Seleccione un estado" itemValue="" />
                <f:selectItems value="#{vistaEmpresas.direccionBean.estados}" var="estado" itemLabel="#{estado}" itemValue="#{estado.idEstado}" />
              </p:selectOneMenu>
              <p:tooltip for="comboboxEdo" value="Indique en que estado de la republica se ubica la empresa" />
              <br />
              <br />
              Municipio:
              &nbsp;
              <p:selectOneMenu id="comboboxMpio" value="#{vistaEmpresas.direccionBean.municipio.idMunicipio}" style="width: 250px" filter="true">
                <p:ajax listener="#{vistaEmpresas.direccionBean.listarColoniasPorMunicipio()}" update="comboboxCol,growl" />
                <f:selectItem itemLabel="Seleccione un municipio o delegaci&oacute;n" itemValue="" />
                <f:selectItems value="#{vistaEmpresas.direccionBean.municipios}" var="municipio" itemLabel="#{municipio}" itemValue="#{municipio.idMunicipio}" />
              </p:selectOneMenu>
              <p:tooltip for="comboboxMpio" value="Indique el municipio en el que se ubica la empresa" />
              <br />
              <br />
              Localidad:
              &nbsp;
              <p:selectOneMenu id="comboboxCol" value="#{vistaEmpresas.direccionBean.colonia.idColonia}" style="width: 250px" filter="true">
                <p:ajax listener="#{vistaEmpresas.direccionBean.agregarCP()}" update="growl" />
                <f:selectItem itemLabel="Seleccione una colonia" itemValue="" />
                <f:selectItems value="#{vistaClientes.direccionBean.colonias}" var="colonia" itemLabel="#{colonia.nombre}" itemValue="#{colonia.idColonia}" />
              </p:selectOneMenu>
              <p:tooltip for="comboboxCol" value="Indique la colonia o localidad en el que se ubica la empresa" />
            </p:overlayPanel>
          </p:commandButton>
        </div>
        <div class="modal-footer" style="text-align: left;">
          <p:commandButton id="creacion" value="Aceptar" actionListener="#{vistaEmpresas.crearEmpresa}" update="growl" />
          <p:tooltip for="creacion" value="Click aqui para registrar a la empresa de manera definitiva" />
        </div>
      </h:form>
    </p:dialog>
    <!-- DIALOGO DE EDITAR EMPRESAS -->
    <p:dialog widgetVar="dlgEditarEmpresa" width="80%" header="Editar una empresa" modal="true" resizable="false">
      <div class="modal-header">
        <h4>Seleccione la empresa y de click en "Editar"</h4>
      </div>
      <div class="modal-body">
        <table>
          <tr>
            <td>
              <h:form id="tablaEmpresas">
                <!-- TABLA CON LAS EMPRESAS REGISTRADAS EN EL SISTEMA -->
                <p:dataTable id="tablaListaEmpresas" var="sujeto" value="#{vistaEmpresas.listaEmpresas}" rowKey="#{sujeto.rfc}" selection="#{vistaEmpresas.sujetoSeleccionado}" selectionMode="single" paginator="true" rows="10" style="width: 500px; text-align: left;">
                  <f:facet name="header">
                    Empresas registradas en el sistema
                  </f:facet>
                  <p:column headerText="Nombre de la empresa" style="width: 290px">
                    <p:outputLabel value="#{sujeto.nombreRazonSocial}" style="font-family: 'Open Sans',sans-serif; font-weight: 700;" />
                  </p:column>
                  <p:column headerText="RFC" style="width: 100px"> 
                    <h:outputText value="#{sujeto.rfc}" style="font-family: 'Open Sans',sans-serif; font-weight: 700;" />
                  </p:column>
                  <f:facet name="footer">
                    <p:commandButton process="tablaListaEmpresas" icon="ui-icon-pencil" value="Editar" actionListener="#{vistaEmpresas.cargarEmpresa()}" />
                  </f:facet>
                </p:dataTable>
              </h:form>
            </td>
            <td>
              <!-- EDICION DE DATOS PRIMARIOS -->
              <h:form id="datosPrimarios">
                <div style="text-align: right;">
                  <h:outputText value="Razon Social:" />
                  <br />
                  <p:inputText value="#{vistaEmpresas.sujetoBean.nombreRazonSocial}" size="50" required="true" requiredMessage="Debe ingresar una razon social" />
                  <br />
                  <h:outputText value="RFC:" />
                  <br />
                  <p:inputText value="#{vistaEmpresas.sujetoBean.rfc}" size="25" required="true" requiredMessage="Debe ingresar un RFC" />
                  <br />
                  <h:outputText value="Nombre Corto:" />
                  <br />
                  <p:inputText value="#{vistaEmpresas.empresaBean.nombreCorto}" size="25" required="true" requiredMessage="Debe ingresar un nombre corto de empresa" />
                  <br />
                  <br />
                  <p:commandButton value="Aceptar" actionListener="#{vistaEmpresas.editarEmpresa()}" update="growl" />
                </div>
              </h:form>
              <br />
              <!-- EDICION DE PRODUCTOS -->
              <h:form id="editaProductos">
                <div style="text-align: right;">
                  <p:dataTable id="tablaEditarProductos" var="producto" value="#{vistaEmpresas.productoBean.listaProductos}" rowKey="#{producto.idProducto}" selection="#{vistaEmpresas.productoSeleccionado}" selectionMode="single" paginator="true" rows="10" emptyMessage="No hay productos registrados." style="width: 620px;">
                    <f:facet name="header">
                      Lista de productos
                    </f:facet>
                    <p:column headerText="Nombre del producto" style="width: 150px;">
                      <p:outputLabel value="#{producto.nombre}" style="font-family: 'Open Sans',sans-serif; font-weight: 700;" />
                    </p:column>
                    <p:column headerText="Descripcion" style="width: 450px;"> 
                      <h:outputText value="#{producto.descripcion}" style="font-family: 'Open Sans',sans-serif; font-weight: 700;" />
                    </p:column>
                    <f:facet name="footer">
                      <p:commandButton process="tablaEditarProductos" icon="ui-icon-pencil" value="Editar" actionListener="#{vistaEmpresas.guardarProducto()}" oncomplete="PF('modalProducto').show();" />
                      <p:commandButton process="tablaEditarProductos" icon="ui-icon-plus" value="Agregar" oncomplete="PF('nuevoProducto').show();" />
                    </f:facet>
                  </p:dataTable>
                </div>
              </h:form>
            </td>
          </tr>
        </table>
      </div>
      <div class="modal-footer">
      </div>
    </p:dialog>






    






  </h:body>
</html>