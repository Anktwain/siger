<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns:h="http://xmlns.jcp.org/jsf/html" 
      xmlns:p="http://primefaces.org/ui" 
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets" 
      xmlns="http://www.w3.org/1999/xhtml"
      xmlns:f="http://xmlns.jcp.org/jsf/core">
  <h:head>
    <meta charset="utf-8"></meta>
    <title>SigerWeb - Visitas</title>
  </h:head>
  <f:metadata>
    <f:event listener="#{indexBean.verificarAcceso('visitas')}" type="preRenderView" />
  </f:metadata>
  <body>
    <p:growl id="growl" showDetail="true" sticky="true" />
    <!-- Overlay Div -->
    <div id="overlay" class="transparent" style="display: none"></div>
    <ui:include src="barraSuperior.xhtml" />
    <ui:include src="barraLateral.xhtml" />
    <div id="main-container">
      <div id="breadcrumb">
        <ul class="breadcrumb">
          <li>
            <i class="fa fa-home">
            </i>
            <a href="#{indexBean.vista}">Inicio</a>
          </li>
          <li class="active">
            Visitas
          </li>
        </ul>
      </div>
      <div class="main-header clearfix">
        <div class="page-title">
          <h3 class="no-margin">Visitas</h3>
          <span>Consulte la lista de archivos listos para impresion.</span>
          <span>Imprima todos los archivos para ser enviados por correo o para que los gestores practiquen las visitas domiciliarias.</span>
          <span>Visualice las visitas y sectorice por bloques segun las mas cercanas.</span>
        </div>
      </div>
      <div class="row">
        <div class="padding-md">
          <div class="col-lg-12">
            <h:form id="listaVisitasForm">
              <p:accordionPanel multiple="false" activeIndex="0">
                <p:tab title="Estadisticas">
                  <div class="col-sm-6" style="padding-left: 50px; padding-right: 40px;">
                    <p:graphicImage library="img" name="mexicoMap.png" width="900" height="450" />
                  </div>
                  <div class="col-sm-3">
                    <div class="row">
                      <div class="col-lg">
                        <p:dataTable id="listaVisitasEstados" var="est" value="#{listaVisitasBean.listaVisitasEstado}" emptyMessage="No existen estadisticas para mostrar." scrollable="true" scrollHeight="420" style="width: 550px;">
                          <p:column style="width: 30px;">
                            <div style="background-color: #FF850A;" />
                          </p:column>
                          <p:column headerText="Estado" style="width:270px;">
                            <h:outputText value="#{est.estado}" />
                          </p:column>
                          <p:column headerText="Visitas" style="width:100px;">
                            <h:outputText value="#{est.visitas}" />
                          </p:column>
                          <p:column headerText="Correo" style="width:100px;">
                            <h:outputText value="#{est.correo}" />
                          </p:column>
                        </p:dataTable>
                      </div>
                    </div>
                  </div>
                </p:tab>
                <p:tab title="Visita domiciliaria">
                  <p:contextMenu for="listaVisitas" style="width:250px;">
                      <p:menuitem value="Ver en Google Maps Â®" icon="ui-icon-flag" actionListener="#{listaVisitasBean.prepararDireccion()}" />
                    <p:menuitem value="Cercanias" icon="ui-icon-zoomout" actionListener="#{listaVisitasBean.prepararDireccion()}" />
                  </p:contextMenu>
                  <p:dataTable id="listaVisitas" var="v" value="#{listaVisitasBean.listaVisitas}" selection="#{listaVisitasBean.visitaSeleccionada}" selectionMode="single" rowKey="#{v.idImpresion}" emptyMessage="No se han generado visitas." paginator="true" rows="15" paginatorPosition="bottom" paginatorAlwaysVisible="false">
                    <p:column headerText="Credito" style="width:100px;">
                      <h:outputText value="#{v.credito.numeroCredito}" />
                    </p:column>
                    <p:column headerText="Deudor" style="width:300px;">
                      <h:outputText value="#{v.credito.deudor.sujeto.nombreRazonSocial}" />
                    </p:column>
                    <p:column headerText="Calle y numero" style="width:200px">
                      <h:outputText value="#{v.direccion.calle}" />
                    </p:column>
                    <p:column headerText="Colonia" style="width:300px;">
                      <h:outputText value="#{v.direccion.colonia.tipo} #{v.direccion.colonia.nombre}" />
                    </p:column>
                    <p:column headerText="Municipio" style="width:150px;">
                      <h:outputText value="#{v.direccion.municipio.nombre}" />
                    </p:column>
                    <p:column headerText="Estado" style="width:50px;">
                      <h:outputText value="#{v.direccion.estadoRepublica.abreviatura}" />
                    </p:column>
                    <p:column headerText="C.P." style="width:50px;">
                      <h:outputText value="#{v.direccion.colonia.codigoPostal}" />
                    </p:column>
                  </p:dataTable>
                </p:tab>
                <p:tab title="Correo ordinario">
                  <p:dataTable id="listaPorCorreos" var="c" value="#{listaVisitasBean.listaCorreo}" emptyMessage="No se han generado visitas." paginator="true" rows="15" paginatorPosition="bottom" paginatorAlwaysVisible="false">
                    <p:column headerText="Credito" style="width:100px;">
                      <h:outputText value="#{c.credito.numeroCredito}" />
                    </p:column>
                    <p:column headerText="Deudor" style="width:300px;">
                      <h:outputText value="#{c.credito.deudor.sujeto.nombreRazonSocial}" />
                    </p:column>
                    <p:column headerText="Calle y numero" style="width:200px">
                      <h:outputText value="#{c.direccion.calle}" />
                    </p:column>
                    <p:column headerText="Colonia" style="width:300px;">
                      <h:outputText value="#{c.direccion.colonia.tipo} #{c.direccion.colonia.nombre}" />
                    </p:column>
                    <p:column headerText="Municipio" style="width:150px;">
                      <h:outputText value="#{c.direccion.municipio.nombre}" />
                    </p:column>
                    <p:column headerText="Estado" style="width:50px;">
                      <h:outputText value="#{c.direccion.estadoRepublica.abreviatura}" />
                    </p:column>
                    <p:column headerText="C.P." style="width:50px;">
                      <h:outputText value="#{c.direccion.colonia.codigoPostal}" />
                    </p:column>
                  </p:dataTable>
                </p:tab>
              </p:accordionPanel>
            </h:form>
          </div>
        </div>
      </div>
    </div><!-- /main-container -->
    <!-- Footer ================================================== -->
    <ui:include src="barraInferior.xhtml" />
  </body>
</html>