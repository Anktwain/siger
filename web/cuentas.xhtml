<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns:f="http://xmlns.jcp.org/jsf/core" 
      xmlns:h="http://xmlns.jcp.org/jsf/html" 
      xmlns:p="http://primefaces.org/ui" 
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets" 
      xmlns="http://www.w3.org/1999/xhtml">
  <h:head>
    <meta charset="utf-8"></meta>
    <title>SigerWeb - Cuentas</title>
  </h:head> 
  <h:body>
    <p:growl id="growl" showDetail="true" sticky="true" />
    <!-- Overlay Div -->
    <div id="overlay" class="transparent" style="display: none"></div>
    <ui:include src="barraSuperior.xhtml" />
    <ui:include src="barraLateral.xhtml" />
    <div id="main-container">
      <div id="breadcrumb">
        <ul class="breadcrumb">
          <li>
            <i class="fa fa-home">
            </i>
            <a href="panelAdministrativo.xhtml">Inicio</a>
          </li>
          <li class="active">
            Cuentas
          </li>
        </ul>
      </div>
      <div class="main-header clearfix">
        <div class="page-title">
          <h3 class="no-margin">Cuentas</h3>
          <span>Consulte todas las cuentas que su despacho esta gestionando</span>
        </div>
      </div>
      <div class="row">
        <div class="padding-md">
          <div class="col-lg-12">
            <h:form id="formCuentas">
              <p:contextMenu for="cuentas" style="width:200px;">
                <p:menuitem value="Ver Detalle" icon="ui-icon-check" actionListener="#{cuentasVistaBean.selectorDeVista()}" />
                <p:menuitem value="Devolver" icon="ui-icon-alert" oncomplete="PF('confirmacionDialog').show();" />
              </p:contextMenu>
              <p:dialog id="dlg1" widgetVar="confirmacionDialog" modal="true" header="Confirme esta devolucion">
                <h:outputText value="Esta seguro de que desea devolver este credito?" />
                <br />
                <br />
                <h:outputText value="Esta accion hara que el credito ya no se pueda gestionar." />
                <br />
                <br />
                Seleccione el concepto de devolucion:
                <br />
                <p:selectOneMenu id="concepto" value="#{cuentasVistaBean.conceptoSeleccionado.idConceptoDevolucion}" style="width:200px">
                  <f:selectItem itemLabel="" itemValue="0" />
                  <f:selectItems value="#{cuentasVistaBean.listaConceptos}" var="c" itemLabel="#{c.concepto}" itemValue="#{c.idConceptoDevolucion}" />
                </p:selectOneMenu>
                <br />
                Observaciones:
                <br />
                <p:inputText value="#{cuentasVistaBean.observaciones}" style="width:300px" />
                <br />
                <br />
                <p:commandButton value="Si" icon="ui-icon-check" actionListener="#{cuentasVistaBean.devolverDirecto()}" update="growl" />
                <p:commandButton value="No" icon="ui-icon-close" oncomplete="PF('confirmacionDialog').hide();" />
              </p:dialog>
              <p:dataTable id="cuentas" var="c" value="#{cuentasVistaBean.creditosGestionables}" rowKey="#{c.numeroCredito}" selection="#{cuentasVistaBean.creditoSeleccionado}" emptyMessage="No existen creditos gestionables." selectionMode="multiple" paginator="true" rows="15" paginatorPosition="bottom" filteredValue="#{cuentasVistaBean.filtrados}">
                <p:column headerText="Credito" style="width:130px;" filterBy="#{c.numeroCredito}">
                  <h:outputText value="#{c.numeroCredito}"/>
                </p:column>
                <p:column headerText="Deudor" style="width:500px;" filterBy="#{c.deudor.sujeto.nombreRazonSocial}"> 
                  <h:outputText value="#{c.deudor.sujeto.nombreRazonSocial}"/>
                </p:column>
                <p:column headerText="Institucion" style="width:130px;" filterBy="#{c.producto.institucion.nombreCorto}"> 
                  <h:outputText value="#{c.producto.institucion.nombreCorto}"/>
                </p:column>
                <p:column headerText="Tipo de credito" style="width:150px;" filterBy="#{cuentasVistaBean.etiquetarTipoCredito(c.tipoCredito)}"> 
                  <h:outputText value="#{cuentasVistaBean.etiquetarTipoCredito(c.tipoCredito)}"/>
                </p:column>
                <p:column headerText="Producto" filterBy="#{c.producto.nombre}"> 
                  <h:outputText value="#{c.producto.nombre}"/>
                </p:column>
                <p:column headerText="Saldo vencido" style="width:150px;" filterBy="#{c.monto}"> 
                  <h:outputText value="#{c.monto}">
                    <f:convertNumber  maxFractionDigits="2" currencySymbol="$" minFractionDigits="2" type="currency" />
                  </h:outputText>
                </p:column>
                <p:column headerText="Gestor asignado" style="width:130px;" filterBy="#{c.gestor.usuario.nombreLogin}"> 
                  <h:outputText value="#{c.gestor.usuario.nombreLogin}"/>
                </p:column>
              </p:dataTable>
            </h:form>
          </div>
        </div>
      </div>
    </div><!-- /main-container -->
    <!-- Footer ================================================== -->
    <ui:include src="barraInferior.xhtml" />
  </h:body>
</html>